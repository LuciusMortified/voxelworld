# Voxel World — Product Requirements Document (PRD)

**Версия:** 0.3   **Дата:** 3 июля 2025 г.

> *«Строим легенду, куб за кубом»*

---

## 1. Видение и цели

### 1.1 Видение

Voxel World — это фэнтезийная voxel‑песочница, где игрок свободно исследует процедурно‑генерируемый мир, влияет на ход глобальных событий и сам задаёт темп развития. Проект делается «для души», но с профессиональным подходом: хочется создать игру, которая вдохновляет на творчество, поощряет исследование и живёт собственной жизнью даже без участия игрока.

### 1.2 Качественные цели

* **Эмерджентный геймплей.** Мир реагирует на действия игрока: поселения растут, фракции ведут войны, погода влияет на события.
* **Глубокая RPG‑прогрессия.** Классы и экипировка образуют разные пути развития, основанные на стиле игры.
* **Живой сим‑мир.** NPC самостоятельно строят, добывают ресурсы и расширяют свои поселения без участия игрока.
* **Реактивные фракции и дипломатия.** Репутация влияет на торговлю, альянсы и военные конфликты.
* **Сессионный ко‑оп.** Лёгкое приглашение друзей, drop‑in/drop‑out до 8 игроков.
* **Уважение к игроку.** Минимум гринда, отсутствие pay‑to‑win, офлайн‑режим, гибкая сложность.

### 1.3 Критерии готовности продукта

* **Основной игровой цикл.** Игрок без посторонней помощи:

    1. создаёт новый мир;
    2. создаёт персонажа с выбранной расой и классом;
    3. выполняет не менее **трёх** квестов разных типов (бой, доставка, защита);
    4. приглашает друга в свой мир;
    5. вместе с другом побеждает мини‑босса подземелья.

* **Мультиплеер.** Второй игрок подключается к хосту < 2 мин.; синхронизация позиций, NPC и инвентаря проходит без заметных артефактов (не более **1 desync‑события на 10 минут** игры).

* **Производительность.** FPS ≥ 60 на GTX 1650 в сцене «деревня + бой 10 NPC»; задержка между игроками < 120 мс; утечки памяти < 50 МБ за **1 час** сессии.

* **Стабильность.** 0 крашей и потерь данных за **10‑часовой soak‑тест**; автосейв корректно загружает мир.

* **Пользовательский опыт.** ≥ 90 % тестеров оценивают управление и интерфейс **4 из 5** или выше; жалоб на непонятные механики < 10 % от общего фидбэка.

---

## 2. Геймплейные столпы

| Столп                    | Краткое описание                                                                                               |
| ------------------------ | -------------------------------------------------------------------------------------------------------------- |
| **Исследование**         | Проц. мир → биомы, подземелья, секреты. Туман войны, редкие ресурсы в опасных зонах.                           |
| **RPG‑прогрессия**       | 4 класса, прокачка через экипировку и редкие книги навыков. Нет жёсткой «ветки» — стиль игры диктует развитие. |
| **Фракции & дипломатия** | Пять рас со своими целями; репутация открывает торговлю, союзные отряды или, наоборот, нападения на базу.      |
| **Ко‑оп**                | До 8 игроков в одном мире; совместные квесты, общий чат, свободное PVP по согласию.                            |

---

## 3. Мир и контент

### 3.1 Биомы и ландшафт

* **Луга, Леса, Тундра, Пустыня, Вулканические земли, Пещеры, Подземелья тьмы, Побережья.**
* Каждый биом определяет доступные ресурсы (руда, растения, животные) и вероятность генерации структур (руины, лагеря монстров).
* Высота мира — 1024 блоков; уровень моря — 512.

### 3.2 Живые фракции

* **Люди, Эльфы, Орки, Гоблины, Нежить.**
* Поселения обладают уровнем развития (I–V), численностью, отношениям к игроку.
* Фракции воюют за территории; игрок может наниматься на службу или провоцировать конфликт.

### 3.3 Вода и другие жидкости

* **Вода** заполняет соседний пустой блок раз в 5 игровых секунд, формируя плавную «ступенчатую» волну.
* Плотность/давление игнорируются: уровень воды — целое число блоков.
* План на будущее: добавить лаву и кислоту с повреждением.

### 3.4 Погода и время

* Суточный цикл 20 минут. Освещение и активность существ зависят от времени.
* Простая система погоды: ясно, дождь/снег, гроза. Погода влияет на скорость передвижения и силу дальнего боя.

### 3.5 Квесты и события

* **Локальные** — защита поселения, доставка ресурсов.
* **Глобальные** — вторжение фракции, открытие портала, сезон охоты.
* Генератор задач комбинирует цель, локацию, препятствие, награду.

---

## 4. Игрок и взаимодействие

### 4.1 Создание персонажа

* Раса → стартовый биом.
* Класс (воин / разбойник / лучник / маг) — окончательный выбор.
* Кастомизация внешности (цвет кожи, волос, аксессуары).

### 4.2 Инвентарь и экипировка

* Карманные слоты: 4–6; слоты экипировки (броня, оружие, аксессуары); отдельная сумка на 12–24 слота.
* Вес предметов влияет на скорость; лимит поднимается талантом «Выносливость».

### 4.4 UI/UX

* Минималистичный HUD: здоровье, выносливость, манна, компас.
* Контекстные подсказки при наведении на объект.
* Полное управление с клавиатуры+мыши; продумать схему для геймпада.

---

## 5. Системные функции (High‑Level)

| Подсистема       | Краткое требование                                                                                                |
| ---------------- | ----------------------------------------------------------------------------------------------------------------- |
| **Физика**       | AABB‑коллизии блоков, капсула игрока, триггеры. Вода распространяется по правилу соседства.                       |
| **Рендеринг**    | Vulkan, плоское освещение без текстур, мягкие тени, объёмный свет, GPU culling.                                   |
| **Сеть**         | P2P через UDP + DTLS. Репликация только релевантных сущностей (interest management).                              |
| **Аудио**        | Зональный ambient, фоли вокселя, 3D‑позиционирование звуков.                                                      |
| **Сохранения**   | Мгновенный автосейв каждые 5 минут; мир сохраняется в папку `Worlds/<name>`; совместим между версиями (миграция). |
| **Тестирование** | Консоль с общими логами, встроенный профайлер, лог функций генератора квестов.                                    |

---

## 6. Дорожная карта

| Этап                   | Цели                                                                                                                                     | Результат «готово»                                                                                                    |
| ---------------------- | ---------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------- |
| **Tech Foundation**    | Базовый каркас движка (C++/Vulkan), базовые техники рендеринга (тени, освещение), интеграция ImGui для интерфейсов утилит                | Движок выводит статичную освещённую сцену с тенями и ImGui‑окном                                                      |
| **Tooling Prototype**  | **Sculptor**: моделирование/анимация и экспорт .vxm;  **Architect**: редактирование зданий (поверхностные строения) и комнат подземелий; | Движок загружает .vxm‑модель из Sculptor; комната или здание из Architect появляется в мире при процедурной генерации |
| **Gameplay Prototype** | Базовый рендер, камера, перемещение, ближний бой, разрушаемые блоки                                                                      | Игрок перемещается и сражается с одним видом врага в маленькой сцене                                                  |
| **Pre‑Alpha**          | Проц. генератор биомов, вода, один класс, локальный сейв                                                                                 | Игрок создаёт мир, исследует остров, выполняет одиночный квест                                                        |
| **Alpha**              | Сетевой ко‑оп (2 игрока), квестовая система, базовый ИИ NPC                                                                              | Два игрока совместно завершают квест «Оборона деревни»                                                                |
| **Beta**               | 5 рас, дипломатия, экономика между поселениями, баланс боёв                                                                              | Игрок может вступить в альянс или спровоцировать войну любой фракции                                                  |
| **Release 1.0**        | Полировка UX, контент высокого уровня, генератор подземелий, сюжетные квесты                                                             | Мир со связным лором, цепочки сюжетных квестов, стабильная производительность                                         |

## 7. Риски и план их снижения

1. **Распухание объёма работ.** Приоритизировать ключевые столпы, фиксировать скоуп на каждой стадии, откладывать второстепенные идеи в «ледник».
2. **Сетевой трафик и задержки в ко‑опе.** Interest‑менеджмент, агрегация пакетов, адаптивная частота обновлений в зависимости от RTT.
3. **Сложность процедурной генерации контента.** Ограничить параметрическое пространство, модульно тестировать генераторы, собирать телеметрию аномалий.
4. **Синхронизация воды и деформации мира.** Патчи блоков с приоритетом важности, периодические снапшоты, клиентская интерполяция.
5. **Производительность на слабых ПК.** Динамически снижать дальность видимости, качество теней и плотность эффектов; адаптивный LOD.
6. **Нестабильность сохранений.** Версионирование форматов, двойные автосейвы, миграционные скрипты между версиями.
7. **Баланс классов и фракций.** Telemetry боёв, автоматические метрики «time‑to‑kill» и «favorability», быстрые правки JSON‑конфигов.
8. **Одиночная разработка и выгорание.** Чёткие микро‑цели, чередование «творчество/техник», регулярные периоды отдыха.
